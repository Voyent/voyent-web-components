<link rel="import" href="../../polymer/polymer.html">
<link rel="import" href="../voyent-io-import/voyent-io-import.html">
<link rel="import" href="../../iron-flex-layout/classes/iron-flex-layout.html">
<link rel="import" href="../../paper-button/paper-button.html">
<link rel="import" href="../../paper-input/paper-input.html">
<link rel="import" href="../../paper-item/paper-item.html">
<link rel="import" href="../../paper-item/paper-item-body.html">
<link rel="import" href="../../paper-listbox/paper-listbox.html">
<link rel="import" href="../../paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../voyent-code-editor/voyent-code-editor.html">

<!--
Displays a transport editor that can build message templates for various technologies

@demo demo.html
-->
<dom-module id="voyent-transport-editor">
    <template>
        <style type="text/css">
           .checkboxRow label {
               display: inline-block;
           }
           .code-editor {
               width: 100%;
               min-height: 200px;
           }
           .inputWrap {
               margin-bottom: 10px;
               width: 95%;
           }
           .inputWrap input[type=text], .inputWrap textarea {
               width: 95%;
           }
           .inputWrap select {
               width: 30%;
           }
           .inputWrap b {
               display: block;
               font-size: 14px;
           }
           .overrideWrap, .overrideWrapGlobal {
               margin-left: 20px;
               width: 90%;
               font-size: 12px;
           }
           .overrideWrapGlobal label {
               font-size: 10px;
               font-weight: normal;
           }
           .overrideWrapGlobal {
               width: auto;
           }
           pre {
               overflow: scroll;
           }
        </style>
        
        <div>
            <!-- Commented out as we want all transports to be enabled for now, and just let the service decide how to cascade between them
            <table cellpadding="5" cellspacing="0" width="90%">
                <tr>
                    <td colspan="2" class="checkboxRow">
                        Enable Transport:
                        
                        <template is="dom-if" if="[[allowBrowser]]">
                            <label>
                                <input type="checkbox" checked="{{_tool.transport.browser::change}}"/>
                                Browser
                            </label>
                        </template>
                        <template is="dom-if" if="[[allowCloud]]">
                            <label>
                                <input type="checkbox" checked="{{_tool.transport.cloud::change}}"/>
                                Cloud
                            </label>
                        </template>
                        <template is="dom-if" if="[[allowSMS]]">
                            <label>
                                <input type="checkbox" checked="{{_tool.transport.sms::change}}"/>
                                SMS
                            </label>
                        </template>
                        <template is="dom-if" if="[[allowEmail]]">
                            <label>
                                <input type="checkbox" checked="{{_tool.transport.email::change}}"/>
                                Email
                            </label>
                        </template>
                        <template is="dom-if" if="{{noTransports}}">
                            No transports were enabled for this component
                        </template>
                    </td>
                </tr>
            </table>
            -->
            
            <template is="dom-if" if="{{!noTransports}}">
                <div class="inputWrap">
                    <b>Expiry Time</b>
                    <select value="{{_tool.expire_time.global::change}}">
                        <option value="30">30 minutes</option>
                        <option value="60">1 hour</option>
                        <option value="120">2 hours</option>
                        <option value="480">8 hours</option>
                        <option value="1440">1 day</option>
                        <option value="4320">3 days</option>
                        <option value="10080">1 week</option>
                        <option value="43200">1 month</option>
                    </select>
                    <table class="overrideWrapGlobal">
                        <tr>
                            <td>Override:</td>
                            <td><i>N/A (Global)</i></td>
                        </tr>
                    </table>
                </div>
                
                <div class="inputWrap">
                    <b>Icon</b>
                    <textarea rows="2" value="{{_tool.icon.global::input}}"></textarea>
                    <table class="overrideWrapGlobal">
                        <tr>
                            <td>Override:</td>
                            <td><i>N/A (Global)</i></td>
                        </tr>
                    </table>
                </div>
                
                <div class="inputWrap">
                    <b>Subject</b>
                    <textarea rows="2" value="{{_tool.subject.global::input}}"></textarea>
                    <table class="overrideWrap">
                        <tr>
                            <td>Override:</td>
                            <td>
                                <template is="dom-if" if="{{_tool.transport.browser}}">
                                <label><input type="checkbox" checked="{{_tool.subject.specbrowser::change}}"/>Browser</label>
                                </template><template is="dom-if" if="{{_tool.transport.cloud}}">
                                <label><input type="checkbox" checked="{{_tool.subject.speccloud::change}}"/>Cloud</label>
                                </template><template is="dom-if" if="{{_tool.transport.sms}}">
                                <label><input type="checkbox" checked="{{_tool.subject.specsms::change}}"/>SMS</label>
                                </template><template is="dom-if" if="{{_tool.transport.email}}">
                                <label><input type="checkbox" checked="{{_tool.subject.specemail::change}}"/>Email</label>
                                </template>
                            </td>
                        </tr>
                    <template is="dom-if" if="{{_tool.subject.specbrowser}}">
                        <tr>
                            <td>Browser:</td>
                            <td><input type="text" placeholder="Browser Subject" value="{{_tool.subject.browser::input}}"/></td>
                        </tr>
                    </template>
                    <template is="dom-if" if="{{_tool.subject.speccloud}}">
                        <tr>
                            <td>Cloud:</td>
                            <td><input type="text" placeholder="Cloud Subject" value="{{_tool.subject.cloud::input}}"/></td>
                        </tr>
                    </template>
                    <template is="dom-if" if="{{_tool.subject.specsms}}">
                        <tr>
                            <td>SMS:</td>
                            <td><input type="text" placeholder="SMS Subject" value="{{_tool.subject.sms::input}}"/></td>
                        </tr>
                    </template>
                    <template is="dom-if" if="{{_tool.subject.specemail}}">
                        <tr>
                            <td>Email:</td>
                            <td><input type="text" placeholder="Email Subject" value="{{_tool.subject.email::input}}"/></td>
                        </tr>
                    </template>
                    </table>
                </div>
                
                <div class="inputWrap">
                    <b>Details</b>
                    <textarea value="{{_tool.details.global::input}}"></textarea>
                    <table class="overrideWrap">
                        <tr>
                            <td>Override:</td>
                            <td>
                                <template is="dom-if" if="{{_tool.transport.browser}}">
                                <label><input type="checkbox" checked="{{_tool.details.specbrowser::change}}"/>Browser</label>
                                </template><template is="dom-if" if="{{_tool.transport.cloud}}">
                                <label><input type="checkbox" checked="{{_tool.details.speccloud::change}}"/>Cloud</label>
                                </template><template is="dom-if" if="{{_tool.transport.sms}}">
                                <label><input type="checkbox" checked="{{_tool.details.specsms::change}}"/>SMS</label>
                                </template><template is="dom-if" if="{{_tool.transport.email}}">
                                <label><input type="checkbox" checked="{{_tool.details.specemail::change}}"/>Email</label>
                                </template>
                            </td>
                        </tr>
                    <template is="dom-if" if="{{_tool.details.specbrowser}}">
                        <tr>
                            <td>Browser:</td>
                            <td><input type="text" placeholder="Browser Details" value="{{_tool.details.browser::input}}"/></td>
                        </tr>
                    </template>
                    <template is="dom-if" if="{{_tool.details.speccloud}}">
                        <tr>
                            <td>Cloud:</td>
                            <td><input type="text" placeholder="Cloud Details" value="{{_tool.details.cloud::input}}"/></td>
                        </tr>
                    </template>
                    <template is="dom-if" if="{{_tool.details.specsms}}">
                        <tr>
                            <td>SMS:</td>
                            <td><input type="text" placeholder="SMS Details" value="{{_tool.details.sms::input}}"/></td>
                        </tr>
                    </template>
                    <template is="dom-if" if="{{_tool.details.specemail}}">
                        <tr>
                            <td>Email:</td>
                            <td><input type="text" placeholder="Email Details" value="{{_tool.details.email::input}}"/></td>
                        </tr>
                    </template>
                    </table>
                </div>
                
                <div class="inputWrap">
                    <b>URL</b>
                    <textarea value="{{_tool.url.global::input}}"></textarea>
                    <table class="overrideWrap">
                        <tr>
                            <td>Override:</td>
                            <td>
                                <template is="dom-if" if="{{_tool.transport.browser}}">
                                <label><input type="checkbox" checked="{{_tool.url.specbrowser::change}}"/>Browser</label>
                                </template><template is="dom-if" if="{{_tool.transport.cloud}}">
                                <label><input type="checkbox" checked="{{_tool.url.speccloud::change}}"/>Cloud</label>
                                </template><template is="dom-if" if="{{_tool.transport.sms}}">
                                <label><input type="checkbox" checked="{{_tool.url.specsms::change}}"/>SMS</label>
                                </template><template is="dom-if" if="{{_tool.transport.email}}">
                                <label><input type="checkbox" checked="{{_tool.url.specemail::change}}"/>Email</label>
                                </template>
                            </td>
                        </tr>
                    <template is="dom-if" if="{{_tool.url.specbrowser}}">
                        <tr>
                            <td>Browser:</td>
                            <td><input type="text" placeholder="Browser URL" value="{{_tool.url.browser::input}}"/></td>
                        </tr>
                    </template>
                    <template is="dom-if" if="{{_tool.url.speccloud}}">
                        <tr>
                            <td>Cloud:</td>
                            <td><input type="text" placeholder="Cloud URL" value="{{_tool.url.cloud::input}}"/></td>
                        </tr>
                    </template>
                    <template is="dom-if" if="{{_tool.url.specsms}}">
                        <tr>
                            <td>SMS:</td>
                            <td><input type="text" placeholder="SMS URL" value="{{_tool.url.sms::input}}"/></td>
                        </tr>
                    </template>
                    <template is="dom-if" if="{{_tool.url.specemail}}">
                        <tr>
                            <td>Email:</td>
                            <td><input type="text" placeholder="Email URL" value="{{_tool.url.email::input}}"/></td>
                        </tr>
                    </template>
                    </table>
                </div>
                
                <div class="inputWrap">
                    <b>Priority</b>
                    <select value="{{_tool.priority.global::change}}">
                        <option value="default">default</option>
                        <option value="info">info</option>
                        <option value="warn">warn</option>
                        <option value="alert">alert</option>
                        <option value="critical">critical</option>
                    </select>
                    <table class="overrideWrap">
                        <tr>
                            <td>Override:</td>
                            <td>
                                <template is="dom-if" if="{{_tool.transport.browser}}">
                                <label><input type="checkbox" checked="{{_tool.priority.specbrowser::change}}"/>Browser</label>
                                </template><template is="dom-if" if="{{_tool.transport.cloud}}">
                                <label><input type="checkbox" checked="{{_tool.priority.speccloud::change}}"/>Cloud</label>
                                </template><template is="dom-if" if="{{_tool.transport.sms}}">
                                <label><input type="checkbox" checked="{{_tool.priority.specsms::change}}"/>SMS</label>
                                </template><template is="dom-if" if="{{_tool.transport.email}}">
                                <label><input type="checkbox" checked="{{_tool.priority.specemail::change}}"/>Email</label>
                                </template>
                            </td>
                        </tr>
                    <template is="dom-if" if="{{_tool.priority.specbrowser}}">
                        <tr>
                            <td>Browser:</td>
                            <td>
                                <select value="{{_tool.priority.browser::change}}">
                                    <option value="default">default</option>
                                    <option value="info">info</option>
                                    <option value="warn">warn</option>
                                    <option value="alert">alert</option>
                                    <option value="critical">critical</option>
                                </select>
                            </td>
                        </tr>
                    </template>
                    <template is="dom-if" if="{{_tool.priority.speccloud}}">
                        <tr>
                            <td>Cloud:</td>
                            <td>
                                <select value="{{_tool.priority.cloud::change}}">
                                    <option value="default">default</option>
                                    <option value="info">info</option>
                                    <option value="warn">warn</option>
                                    <option value="alert">alert</option>
                                    <option value="critical">critical</option>
                                </select>
                            </td>
                        </tr>
                    </template>
                    <template is="dom-if" if="{{_tool.priority.specsms}}">
                        <tr>
                            <td>SMS:</td>
                            <td>
                                <select value="{{_tool.priority.sms::change}}">
                                    <option value="default">default</option>
                                    <option value="info">info</option>
                                    <option value="warn">warn</option>
                                    <option value="alert">alert</option>
                                    <option value="critical">critical</option>
                                </select>
                            </td>
                        </tr>
                    </template>
                    <template is="dom-if" if="{{_tool.priority.specemail}}">
                        <tr>
                            <td>Email:</td>
                            <td>
                                <select value="{{_tool.priority.email::change}}">
                                    <option value="default">default</option>
                                    <option value="info">info</option>
                                    <option value="warn">warn</option>
                                    <option value="alert">alert</option>
                                    <option value="critical">critical</option>
                                </select>
                            </td>
                        </tr>
                    </template>
                    </table>
                </div>
                
                <div class="inputWrap">
                    <b>Payload</b>
                    <voyent-code-editor class="code-editor" value="{{_tool.payload}}"></voyent-code-editor>
                </div>
            </template>
            
            <template is="dom-if" if="[[debug]]">
                <hr/>
                <b>Notification JSON Preview</b>
                <pre>[[value]]</pre>
            </template>
        </div>
    </template>
</dom-module>

<script src="voyent-transport-editor.js"></script>