<!--
	@license
	Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
	This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
	The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
	The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
	Code distributed by Google as part of the polymer project is also
	subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<!doctype html>
<html>
	<head>
		<meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
		<title>BridgeIt Web Components Demo</title>

		<script src="//cdn.lukej.me/es6-promise/1.0.0/promise.min.js"></script>
		<script>
			if( !("Promise" in window)){
				window.Promise = ES6Promise.Promise;
			}
		</script>
		<script src="//bridgeit.github.io/bridgeit.js/src/bridgeit.js"></script>
		<script src="//bridgeit.github.io/bridgeit.io.js/lib/bridgeit.io.js"></script>

		<script src="../../webcomponentsjs/webcomponents.min.js"></script>
		<link rel="import" href="bridgeit-locations.html">

		<link rel="stylesheet" href="demo.css"/>
		
	</head>
	<body unresolved>

		<h1>BridgeIt Locations Map Component Demo</h1>
  		<h3>Login with your BridgeIt Account Information</h3>
  		<hr/>
  		<div class="container">
	  		<form>
	  			<div>
					<label>Account:
						<input id="account" type="text"/>
					</label>
				</div>
				<div>
					<label>Realm:
						<input id="realm" type="text"/>
					</label>
				</div>
				<div>
					<label>Username:
						<input id="username" type="text"/>
					</label>
				</div>
				<div>
					<label>Password:
						<input id="password" type="password"/>
					</label>
				</div>
				<a onclick="login()">Login</a>

				<div class="settings">
					<div>
						<label>Show User Location Updates:
							<input type="checkbox" checked 
								onclick="document.getElementById('userLocations').setAttribute('showUserLocations', this.checked);"/>
						</label>
					</div>

					<div>
						<label>Show Regions:
							<input type="checkbox" onclick="document.getElementById('userLocations').setAttribute('showRegions', this.checked);"/>
						</label>
					</div>

					<div>
						<label>Show Points of Interest:
							<input type="checkbox" onclick="document.getElementById('userLocations').setAttribute('showPOIs', this.checked);"/>
						</label>
					</div>

					<div>
						<label>Height:
							<select onchange="document.getElementById('userLocations').setAttribute('height', this.value)">
								<option selected>200px</option>
								<option>400px</option>
								<option>600px</option>
								<option>800px</option>
							</select>
						</label>
					</div>
				</div>
			</form>


			<!-- 3. Declare the element by its tag. -->
			<bridgeit-locations id="userLocations" accessToken="" realm="" account="">
			</bridgeit-locations>
			
		</div>

		<script type="text/javascript">
			function login(event){
				var account = document.getElementById('account').value;
				var realm = document.getElementById('realm').value;
				var username = document.getElementById('username').value;
				var password = document.getElementById('password').value;

				bridgeit.io.auth.connect({
					account: account,
					realm: realm,
					username: username,
					password: password
				}).then(function(){
					setCredentialsOnComponent();
				})
			}

			function setCredentialsOnComponent(){

				var elem = document.getElementById('userLocations');

				var account = bridgeit.io.auth.getLastKnownAccount();
				if( account ){
					elem.setAttribute('account', account);
					document.getElementById('account').value = account;
				}

				var realm = bridgeit.io.auth.getLastKnownRealm();
				if( realm ){
					elem.setAttribute('realm', realm);
					document.getElementById('realm').value = realm;
				}

				var token = bridgeit.io.auth.getLastAccessToken();
				if( token ){
					elem.setAttribute('accessToken', token);
					document.getElementById('username').value = bridgeit.io.auth.getLastKnownUsername();
				}
				
			}

			//initialize known credentials
			setCredentialsOnComponent();
			
		</script>
	</body>
</html>
