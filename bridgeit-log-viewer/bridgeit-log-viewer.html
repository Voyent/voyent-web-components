<link rel="import" href="../../polymer/polymer.html">

<!--
Displays a table for viewing, sorting and querying log information stored by the BridgeIt Services. Requires BridgeIt Account Admin credentials.

Example:

    <bridgeit-log-viewer accesstoken="xxx"
                         account="myAccount"
                         paginator
                         header
                         footer>
    </bridgeit-log-viewer>

@demo demo.html
-->
<dom-module id="bridgeit-log-viewer">
    <template>
        <style type="text/css">
            table {
                margin:0 auto;
                border: 1px solid #ddd;
                border-spacing: 0;
                border-collapse: collapse;
                @apply(--log-viewer-table);
            }
            tr {
                @apply(--log-viewer-tr);
            }
            td {
                border: 1px solid #ddd;
                @apply(--log-viewer-td);
            }
            thead {
                border: 1px solid #ddd;
                @apply(--log-viewer-thead);
            }
            tbody {
                @apply(--log-viewer-tbody);
            }
            tfoot {
                border: 1px solid #ddd;
                @apply(--log-viewer-tfoot);
            }
            th {
                border: 1px solid #ddd;
                @apply(--log-viewer-th);
            }
            table > tbody > tr.info > td {
                background-color:#FFF;
                @apply(--log-viewer-info-td);
            }
            table > tbody > tr.debug > td {
                background-color:#d9edf7;
                @apply(--log-viewer-debug-td);
            }
            table > tbody > tr.warn > td {
                background-color:#fcf8e3;
                @apply(--log-viewer-warn-td);
            }
            table > tbody > tr.error > td {
                background-color:#f2dede;
                @apply(--log-viewer-error-td);
            }
            .buttonContainer {
                text-align:center;
                @apply(--log-viewer-button-container);
            }
            .buttonContainer button {
                @apply(--log-viewer-button);
            }
            p {
                text-align:center;
                @apply(--log-viewer-p);
            }
        </style>
        <template is="dom-if" if="{{_hasLogs}}">
            <template is="dom-if" if="{{paginator}}">
                <div class="buttonContainer">
                    <button on-click="lastPage" disabled="{{!_hasPreviousPage}}">Last</button>
                    <button on-click="previousPage" disabled="{{!_hasPreviousPage}}">Previous Page</button>
                    <button on-click="nextPage" disabled="{{!_hasNextPage}}">Next Page</button>
                    <button on-click="firstPage" disabled="{{!_hasNextPage}}">First</button>
                </div>
            </template>
            <table>
                <template is="dom-if" if="{{header}}">
                    <thead>
                        <template is="dom-if" if="{{_time}}">
                            <th>Time</th>
                        </template>
                        <template is="dom-if" if="{{_tx}}">
                            <th>Transaction Code</th>
                        </template>
                        <template is="dom-if" if="{{_service}}">
                            <th>Service</th>
                        </template>
                        <template is="dom-if" if="{{_realmName}}">
                            <th>Realm</th>
                        </template>
                        <template is="dom-if" if="{{_username}}">
                            <th>Username</th>
                        </template>
                        <template is="dom-if" if="{{_message}}">
                            <th>Message</th>
                        </template>
                    </thead>
                </template>
                <tbody>
                    <template is="dom-repeat" items="{{_currentPage}}">
                        <tr class$="{{item.level}}">
                            <template is="dom-if" if="{{_time}}">
                                <td>{{item.time}}</td>
                            </template>
                            <template is="dom-if" if="{{_tx}}">
                                <td>{{item.tx}}</td>
                            </template>
                            <template is="dom-if" if="{{_service}}">
                                <td>{{item.service}}</td>
                            </template>
                            <template is="dom-if" if="{{_realmName}}">
                                <td>{{item.realmName}}</td>
                            </template>
                            <template is="dom-if" if="{{_username}}">
                                <td>{{item.username}}</td>
                            </template>
                            <template is="dom-if" if="{{_message}}">
                                <td>{{item.message}}</td>
                            </template>
                        </tr>
                    </template>
                </tbody>
                <template is="dom-if" if="{{footer}}">
                    <tfoot>
                        <template is="dom-if" if="{{_time}}">
                            <th>Time</th>
                        </template>
                        <template is="dom-if" if="{{_tx}}">
                            <th>Transaction Code</th>
                        </template>
                        <template is="dom-if" if="{{_service}}">
                            <th>Service</th>
                        </template>
                        <template is="dom-if" if="{{_realmName}}">
                            <th>Realm</th>
                        </template>
                        <template is="dom-if" if="{{_username}}">
                            <th>Username</th>
                        </template>
                        <template is="dom-if" if="{{_message}}">
                            <th>Message</th>
                        </template>
                    </tfoot>
                </template>
            </table>
            <template is="dom-if" if="{{paginator}}">
                <div class="buttonContainer">
                    <button on-click="lastPage" disabled="{{!_hasPreviousPage}}">Last</button>
                    <button on-click="previousPage" disabled="{{!_hasPreviousPage}}">Previous Page</button>
                    <button on-click="nextPage" disabled="{{!_hasNextPage}}">Next Page</button>
                    <button on-click="firstPage" disabled="{{!_hasNextPage}}">First</button>
                </div>
            </template>
        </template>
        <template is="dom-if" if="{{!_hasLogs}}">
            <template is="dom-if" if="{{_noLogs}}">
                <p>Sorry, there are no logs matching that query</p>
            </template>
            <template is="dom-if" if="{{!_noLogs}}">
                <p>One moment, loading logs...</p>
            </template>
        </template>
    </template>
</dom-module>

<script src="./bridgeit-log-viewer.js"></script>