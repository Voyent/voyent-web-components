<link rel="import" href="../../polymer/polymer.html">
<link rel="import" href="../common/imports/voyent.html">
<link rel="import" href="../common/voyent-alert/voyent-alert-map-behaviour.html">
<link rel="import" href="../common/voyent-alert/voyent-alert-behaviour.html">
<link rel="import" href="../../iron-icon/iron-icon.html">
<link rel="import" href="../../iron-icons/iron-icons.html">
<link rel="import" href="../../paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../paper-radio-group/paper-radio-group.html">
<link rel="import" href="../../paper-radio-button/paper-radio-button.html">
<link rel="import" href="../../paper-toggle-button/paper-toggle-button.html">


<!--
Displays a map-based tool to allow users to create and edit locations of interest.

Example:

    <voyent-my-locations account="myAccount"
                       realm="myRealm"
                       height="500">
    </voyent-my-locations>

@demo demo.html
-->
<dom-module id="voyent-my-locations">
    <template>
        <style include="voyent-alert-styles" is="custom-style">
            .info-window {
                font-weight: 400;
                -webkit-font-smoothing: antialiased;
            }
            .selected-place {
                text-align:center;
            }
            .selected-place .address {
                margin:10px;
            }
            .selected-place .name {
                margin:5px 10px 10px 10px;
                font-size:14px;
            }
            .selected-place div,
            .selected-place span {
                max-width: 150px;
                word-wrap: break-word;
            }
            .selected-place paper-button {
                margin-bottom:5px;
            }
            .selected-place .name {
                font-weight:bold;
            }
            .autocomplete {
                padding-top: 15px;
            }
            .delete-bttn {
                text-align: center;
                padding-left: 23px;
            }
            .delete-bttn > paper-icon-button {
                width: 38px;
                height: 38px;
            }
            .info-window .toggle-button {
                margin-top:10px;
            }
            .private-residence {
                font-size:15px;
            }
            .custom-control {
                background-color: #FFF;
                text-align: center;
                margin: 10px;
            }
            .custom-control {
                background-color:transparent;
            }
            .custom-control paper-button {
                background-color:#FFF;
                font-size:15px;
                box-shadow: 2px 2px 5px #006542;
                color: #006542;
            }
            .dialog-bttns {
                margin: 0;
                padding: 15px;
            }
            .dialog-title {
                font-weight:bold;
                font-size:17px;
            }
            .dialog-bttns paper-button {
                font-size:12px;
            }
            .modal-dialog .private-residence,
            .name-input {
                margin-top:15px !important;
            }
            .no-margin {
                margin: 0;
            }
            .valign-middle {
                vertical-align: middle;
            }
            .valign-top {
                vertical-align: top;
            }
        </style>
        <div id="container">
            <div id="map"></div>
        </div>
        <div id="infoWindow" class="info-window" hidden>
            <template is="dom-if" if="[[_loadedLocation]]">
                <paper-input id="label"
                             tabindex="1"
                             label="Name"
                             maxlength="30"
                             placeholder="New Name"
                             autocapitalize="words"
                             on-change="_flagLocationForUpdating"
                             value="{{_inputName::input}}">
                </paper-input>
                <div class="toggle-button">
                    <paper-toggle-button id="isPrivateResidence" class="inline valign-middle" tabindex="2"
                                         checked="{{_inputPrivateResidence}}"
                                         on-checked-changed="_flagLocationForUpdating"></paper-toggle-button>
                    <span class="private-residence valign-middle no-select">Private Residence</span>
                </div>
                <div class="delete-bttn">
                    <paper-icon-button tabindex="3" title="Remove Location" icon="delete"
                                       on-click="_removeLocation">
                    </paper-icon-button>
                </div>
            </template>
            <template is="dom-if" if="[[!_loadedLocation]]">
                <div class="selected-place">
                    <paper-input label="Name"
                                 placeholder="New Name"
                                 maxlength="30"
                                 autocapitalize="words"
                                 value="{{_selectedPlace.name::input}}">
                    </paper-input>
                    <div class="address">
                        <div>
                            <template is="dom-if" if="[[_selectedPlace.streetNumber]]">
                                <span>[[_selectedPlace.streetNumber]]</span>
                            </template>
                            <template is="dom-if" if="[[_selectedPlace.route]]">
                                <span>[[_selectedPlace.route]]</span>
                            </template>
                        </div>
                        <div>
                            <template is="dom-if" if="[[_selectedPlace.locality]]">
                                <span>[[_selectedPlace.locality]],</span>
                            </template>
                            <template is="dom-if" if="[[_selectedPlace.political]]">
                                <span>[[_selectedPlace.political]]</span>
                            </template>
                            <template is="dom-if" if="[[_selectedPlace.postalCode]]">
                                <span>[[_selectedPlace.postalCode]]</span>
                            </template>
                        </div>
                    </div>
                    <paper-button class="add-place-bttn" raised title="Add to My Locations" on-click="_addPlaceToMyLocations">
                        Add to My Locations
                    </paper-button>
                </div>
            </template>
        </div>
        <div id="locationButton" class="custom-control" hidden>
            <paper-button raised title="Create a new location" on-click="_addAddressBasedLocation">Add Location...</paper-button>
        </div>
        <paper-dialog id="modalDialog" class="modal-dialog" modal on-keyup="_dialogKeyUp"
                      on-iron-overlay-opened="_fixModalStacking">
            <p class="dialog-title">New Location Details</p>
            <paper-input id="autoComplete" class="autocomplete no-margin" no-label-float tabindex="4" autofocus
                         maxlength="70" autocapitalize="words" on-value-changed="_autoCompleteChanged" value="{{_autocompleteValue}}"
                         on-keyup="_dialogKeyUp" placeholder="Enter an address, postal code, or business name"></paper-input>
            <paper-input class="inline no-margin name-input" autofocus no-label-float tabindex="5" label="Label"
                         maxlength="30" autocapitalize="words"
                         on-keyup="_dialogKeyUp" value="{{_locationName}}"></paper-input>
            <div class="inline no-margin toggle-button">
                <paper-toggle-button class="inline no-margin valign-top" tabindex="6" on-keyup="_dialogKeyUp"
                                     checked="{{_isPrivateResidence}}"></paper-toggle-button>
                <span class="private-residence valign-middle no-select">Private Residence</span>
            </div>
            <div class="dialog-bttns">
                <paper-button raised tabindex="7" title="Cancel" on-click="_closeDialog">Cancel</paper-button>
                <paper-button raised tabindex="8" title="Confirm" on-click="_confirmDialog">Add Location</paper-button>
            </div>
        </paper-dialog>
    </template>
</dom-module>

<script src="voyent-my-locations.js"></script>
