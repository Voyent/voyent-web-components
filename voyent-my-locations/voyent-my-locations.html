<link rel="import" href="../../polymer/polymer.html">
<link rel="import" href="../common/imports/voyent.html">
<link rel="import" href="../common/voyent-alert/voyent-alert-map-behaviour.html">
<link rel="import" href="../common/voyent-alert/voyent-alert-behaviour.html">
<link rel="import" href="../../paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../../iron-selector/iron-selector.html">
<link rel="import" href="../../paper-item/paper-item.html">
<link rel="import" href="../../iron-icon/iron-icon.html">
<link rel="import" href="../../iron-icons/iron-icons.html">
<link rel="import" href="../../paper-icon-button/paper-icon-button.html">

<!--
Displays a map-based tool to allow users to create and edit locations of interest.

Example:

    <voyent-my-locations account="myAccount"
                       realm="myRealm"
                       height="500">
    </voyent-my-locations>

@demo demo.html
-->
<dom-module id="voyent-my-locations">
    <template>
        <style include="voyent-alert-styles" is="custom-style">
            .delete-bttn {
                text-align: center;
                padding-left: 23px;
            }
            .delete-bttn > paper-icon-button {
                width: 38px;
                height: 38px;
            }
            .no-margin {
                margin: 0;
            }
            .dialog-bttns {
                margin: 0;
                padding: 15px;
            }
            .custom-control {
                background-color: #FFF;
                cursor: pointer;
                text-align: center;
                margin: 10px;
            }
            .control-button {
                float:left;
                direction: ltr;
                overflow: hidden;
                text-align: center;
                position: relative;
                color: #191919;
                font-family: Roboto, Arial, sans-serif;
                user-select: none;
                font-size: 11px;
                background-color: #FFF;
                padding: 8px;
                -webkit-background-clip: padding-box;
                background-clip: padding-box;
                box-shadow: rgba(0, 0, 0, 0.3) 0px 1px 4px -1px;
            }
            .control-button.left {
                border-bottom-left-radius: 2px;
                border-top-left-radius: 2px;
            }
            .control-button.right {
                border-bottom-right-radius: 2px;
                border-top-right-radius: 2px;
                border-left: 0px;
            }
            .control-button:hover {
                background-color: #EBEBEB;
                color: #000;
            }
            .dialog-inline {
                display: inline-block;
            }
            .dialog-block {
                display:block;
            }
            #autoComplete {
                padding-top: 15px;
            }
        </style>
        <div id="container">
            <div id="map"></div>
        </div>
        <div id="infoWindow" hidden>
            <paper-input id="label"
                         tabindex="1"
                         label="Label"
                         placeholder="New Label"
                         on-change="_flagLocationForUpdating"
                         value="{{_loadedLocationData.location.location.properties.vras.label::input}}">
            </paper-input>
            <paper-dropdown-menu id="type"
                                 tabindex="2"
                                 label="Type">
                <iron-selector selected="{{_loadedLocationData.location.location.properties.vras.type}}"
                               attr-for-selected="name"
                               class="dropdown-content"
                               on-iron-activate="_flagLocationForUpdating">
                    <template is="dom-repeat" items="[[_locationTypes]]">
                        <paper-item name="{{item}}">{{_returnLocTypeLabel(item)}}</paper-item>
                    </template>
                </iron-selector>
            </paper-dropdown-menu>
            <div class="delete-bttn">
                <paper-icon-button tabindex="4" title="Remove Location" icon="delete"
                                   on-click="_flagLocationForRemoval">
                </paper-icon-button>
            </div>
        </div>
        <div id="markerBttn" class="customMapBttnWrap" hidden>
            <div class="customMapBttn" title="Create a new Location">
                <span>
                    <div class="customMapBttnImg">
                        <img src="../common/voyent-alert/img/drawing.png">
                    </div>
                </span>
            </div>
        </div>
        <div id="customControl" class="custom-control" hidden>
            <div class="control-button left" title="Save Changes" on-click="_saveChanges">
                Save
            </div>
            <div class="control-button right" title="Revert Changes" on-click="_cancelChanges">
                Cancel
            </div>
        </div>
        <paper-dialog id="modalDialog" modal on-keyup="_dialogKeyUp" on-iron-overlay-opened="_fixModalStacking">
            <p>Location Details</p>
            <paper-dropdown-menu tabindex="1"
                                 label="Creation Type"
                                 on-keyup="_dialogKeyUp"
                                 class="dialog-block no-margin">
                <iron-selector selected="{{_creationType}}"
                               attr-for-selected="name"
                               class="dropdown-content">
                        <template is="dom-repeat" items="[[_creationTypes]]">
                        <paper-item name="{{item}}">{{_returnCreateTypeLabel(item)}}</paper-item>
                    </template>
                </iron-selector>
            </paper-dropdown-menu>
            <template is="dom-if" if="{{_isAddress(_creationType)}}">
                <paper-input id="autoComplete" class="no-margin" no-label-float tabindex="2"
                             on-keyup="_dialogKeyUp" placeholder="Enter a location"></paper-input>
            </template>
            <paper-input class="dialog-inline no-margin" autofocus no-label-float tabindex="3" label="Label"
                         on-keyup="_dialogKeyUp" value="{{_locationLabel}}"></paper-input>
            <paper-dropdown-menu tabindex="4"
                                 label="Type"
                                 on-keyup="_dialogKeyUp"
                                 class="no-margin">
                <iron-selector selected="{{_locationType}}"
                               attr-for-selected="name"
                               class="dropdown-content">
                    <template is="dom-repeat" items="[[_locationTypes]]">
                        <paper-item name="{{item}}">{{_returnLocTypeLabel(item)}}</paper-item>
                    </template>
                </iron-selector>
            </paper-dropdown-menu>
            <div class="dialog-bttns">
                <paper-button raised tabindex="5" title="Cancel" on-click="_closeDialog">Cancel</paper-button>
                <paper-button raised tabindex="6" title="Confirm" on-click="_confirmDialog">Confirm</paper-button>
            </div>
        </paper-dialog>
    </template>
</dom-module>

<script src="voyent-my-locations.js"></script>
