<link rel="import" href="../../polymer/polymer.html">
<link rel="import" href="../bridgeit-io-import/bridgeit-io-import.html">
<link rel="import" href="bridgeit-location-behavior.html">

<!--
Show a map of BridgeIt location data and simulate location changes by dragging users around the map or define routes and simulate motion along a path!

Example:

    <bridgeit-location-simulator account="myAccount"
                                 realm="myRealm"
                                 routes='[
                                 {
                                    "label":"ICEsoft Technologies To Calgary Tower",
                                    "origin": "1717 10 St NW, Calgary",
                                    "destination": "101 9 Ave SW, Calgary",
                                    "travelmode": "DRIVING",
                                    "speed": 60,
                                    "frequency": 5
                                 },
                                 {
                                    "label":"Princes Island Park To Fort Calgary",
                                    "user": "jimjones",
                                    "origin": "698 Eau Claire Ave SW, Calgary",
                                    "destination": "750 9th Avenue SE, Calgary",
                                    "travelmode": "BICYCLING",
                                    "speed": 15,
                                    "frequency": 10
                                 }]'>
    </bridgeit-location-simulator>

@demo demo.html
-->
<dom-module id="bridgeit-location-simulator">
    <template>
        <style type="text/css">
            #map {
                width:100%;
                height:400px;
                margin-bottom:10px;
                @apply(--location-sim-map);
            }
            .buttonContainer {
                text-align:center;
                @apply(--location-sim-button-container);
            }
            .buttonContainer button {
                @apply(--location-sim-button);
            }
            ul.tabs-menu {
                list-style-type: none;
                clear: both;
                margin:0;
                float:left;
                width: 95%;
                @apply(--location-sim-tabs);
            }
            ul.tabs-menu li {
                height: 30px;
                line-height: 30px;
                float: left;
                margin-right: 5px;
                border-top: 1px solid #d4d4d1;
                border-right: 1px solid #d4d4d1;
                border-left: 1px solid #d4d4d1;
                cursor:pointer;
                position: relative;
                margin-top: 10px;
                background-color: #CCC;
                @apply(--location-sim-tab);
            }
            ul.tabs-menu li a {
                padding: 10px;
                color: #fff;
                text-decoration: none;
                @apply(--location-sim-tab-label);
            }
            ul.tabs-menu li:first-child {
                @apply(--location-sim-first-tab);
            }
            ul.tabs-menu li.active {
                background-color: #fff;
                @apply(--location-sim-active-tab);
            }
            ul.tabs-menu li.active a {
                color: #000;
                @apply(--location-sim-active-tab-label);
            }
            .tabs-content {
                display: inline-block;
                width: 100%;
                border: 1px solid #d4d4d1;
                @apply(--location-sim-tab-content-container);
            }
            .tab-content {
                padding: 20px;
                clear: both;
                @apply(--location-sim-tab-content);
            }
            .title {
                text-align: center;
                font-weight: bold;
                font-size:18px;
                @apply(--location-sim-title);
            }
            .context-menu {
                border:0;
                position:absolute;
                background:white;
                width: 94px;
                height: 48px;
                font-size:13px;
                @apply(--location-sim-contextmenu);
            }
            .menu-item {
                width:96%;
                height:18px;
                padding:3px 0 1px 2px;
                border:1px solid #ccc;
                cursor:pointer;
                @apply(--location-sim-contextmenu-item);
            }
            .menu-item:hover {
                background:rgb(235,235,235);
                @apply(--location-sim-contextmenu-item-hover);
            }
            .close:before {
                content: 'âœ•';
            }
            .close {
                position: absolute;
                top: 0;
                right: 0;
                cursor: pointer;
                font-size: 10px;
                line-height: 10px;
            }
        </style>
        
        <div id="container">
            <div id="map"></div>
        </div>
        <div class="buttonContainer">
            <button on-click="cancelAll">Stop All</button>
            <button on-click="playAll">Play All</button>
            <button on-click="pauseAll">Pause All</button>
        </div>
        <content select="bridgeit-location-simulations"></content>
        <div class="buttonContainer">
            <button on-click="_resetSimulation">New/Reset</button>
            <template is="dom-if" if="{{!_activeSim}}">
                <button on-click="_saveSimulation">Save</button>
            </template>
            <template is="dom-if" if="{{_activeSim}}">
                <button on-click="_updateSimulation">Update</button>
                <button on-click="_saveSimulation">Clone</button>
                <button on-click="_deleteSimulation">Delete</button>
            </template>
            <button on-click="_addRoute">Add Route</button>
        </div>
        <div class="title">{{_activeSim._id}}</div>
        <div id="tabs-container">
            <ul class="tabs-menu">
                <template is="dom-repeat" items="{{_children}}">
                    <li class$="{{item.tabClass}}"><a on-click="_tabChangeListener"><span>{{item.tabLabel}}</span></a><span class="close" on-click="_tabCloseListener"></span></li>
                </template>
            </ul>
            <div class="tabs-content">
                <template is="dom-repeat" items="{{_children}}">
                    <div hidden$="{{item.contentHidden}}" data-index$="{{index}}" class="tab-content"></div>
                </template>
            </div>
        </div>
        <div id="customControl" hidden>
            <div class="simControl">
                <select id="followableUsers">
                    <option value="-1" selected>Follow User:</option>
                    <template is="dom-repeat" items="{{_followableUsers}}">
                        <option value="{{index}}">{{item.label}}</option>
                    </template>
                </select>
            </div>
        </div>
        <div id="contextMenu" class="context-menu" hidden$="{{_hideContextMenu}}">
            <div id="setAsOrigin" class="menu-item" on-click="_setAsOrigin">Set Origin</div>
            <div id="setAsDestination" class="menu-item" on-click="_setAsDestination">Set Destination</div>
        </div>
    </template>
</dom-module>

<script src="bridgeit-location-simulator.js"></script>
